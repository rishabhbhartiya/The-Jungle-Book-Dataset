# -*- coding: utf-8 -*-
"""The Jungle Book DATA CLEANING.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12WqlSjHwzJLtSoaS3v7sDp5fYewDQWSm
"""

import pandas as pd

dataset = pd.read_csv('/content/THE JUNGLE BOOK.csv')

dataset.head(4)

dataset.rename(columns={"0_x": "EPISODE_NUMBER", "1": "EPISODE TITLE", "2": "DIRECTED BY", "3": "WRITTEN BY", "4": "AIRED DATE", "0_y": "DESCRIPTION"}, inplace=True)

dataset.drop(columns=["Unnamed: 0"], inplace=True)

dataset.head(4)

def remove_unwanted_characters(text):
    modified_text = text.replace('\n\n', '').replace('"', '')
    return modified_text

dataset["DESCRIPTION"] = dataset["DESCRIPTION"].apply(remove_unwanted_characters)

dataset["AIRED DATE"][3]

def process_date(date_string):
  cleaned_date = date_string.split('(')
  return cleaned_date[1]

dataset["AIRED DATE"] = dataset["AIRED DATE"].apply(process_date)

def remove_parenthesis(date_string):
  cleaned_date = date_string.replace(')', '')
  return cleaned_date

dataset["AIRED DATE"] = dataset["AIRED DATE"].apply(remove_parenthesis)

def remove_directedby(text):
  if 'Directed by' in text:
    split_text = text.replace('Directed by: ', '')
    return split_text
  else:
    return text

dataset["DIRECTED BY"] = dataset["DIRECTED BY"].apply(remove_directedby)

dataset[4:10]

def separate_storyboarded(text):
  if 'Storyboarded by' in text:
    split_text = text.replace('Storyboarded by:', ',')
    return split_text
  else:
    return text

separate_storyboarded("Shinji TakahashiStoryboarded by: Takeo Kitahara")

dataset["DIRECTED BY"] = dataset["DIRECTED BY"].apply(separate_storyboarded)

# Apply the splitting logic only if a comma is present
for index, row in dataset.iterrows():
    if ',' in row['DIRECTED BY']:
        split_values = row['DIRECTED BY'].split(',')
        dataset.at[index, 'DIRECTED BY'] = split_values[0]
        dataset.at[index, 'STORY BOARDED'] = split_values[1] if len(split_values) > 1 else ''
    else:
        dataset.at[index, 'STORY BOARDED'] = 'None'

dataset.head(4)

new_order = ["EPISODE_NUMBER", "EPISODE TITLE", "DIRECTED BY", "WRITTEN BY", "STORY BOARDED", "DESCRIPTION", "AIRED DATE"]
dataset = dataset[new_order]

dataset.to_csv("MOWGLI: THE JUNGLE BOOK.csv")

